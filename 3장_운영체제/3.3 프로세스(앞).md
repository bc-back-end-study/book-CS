# 프로세스 (앞)

```
프로세스란 컴퓨터에 실행되고 있는 프로그램을 말한다.
cpu 스케줄링의 대상이 되는 task라는 용어와 같은 의미로 쓰인다.
프로그램이 메모리에 올라가면 프로세스가 되고 이후 운영체제의 cpu 스케줄러에 따라 cpu가 프로세스를 실행한다.
```

## 프로세스의 상태

- ![KakaoTalk_20221105_221953643](https://user-images.githubusercontent.com/83262217/200121960-76c1372d-950b-4258-8438-ba5ad4ad31b9.jpg)

- 생성(New) : 프로세스가 생성된 상태를 의미하며 부모 프로세스의 주소공간을 복사하여 자식프로세스를 생성하는 fork() 또는 새롭게 프로세스를 생성하는 exec()함수를 통해 생성된다. 이때 PCB가 할당된다.
- 대기(Ready) : 대기 상태는 메모리 공간이 충분하면 할당받고 아니면 아닌 상태로 대기하는 상태로 CPU 스케줄러로 부터 소유권을 기다리는 상태이다.
- 대기중단(Ready suspended) : 대기 중단 혹은 지연대기 상태는 프로세스가 기억장치를 제외한 다른 모든 필요한 자원들을 보유한 상태로 메모리 부족으로 일시 중단된 상태를 나타낸다.
- 실행(Running) : 실행상태는 CPU 소우권과 메모리를 할당받고 인스트럭션을 수행중인 상태를 의미한다.
- 중단(Blocked) : 블록상태는 인터럽트등의 이벤트 발생으로 인해 프로세스가 중단된 상태이다.
- 일시중단(Blocked suspended) : 대기중단 상태와 비슷하며 중단된 상태에서 프로세스를 다시 실행하려 했지만 메모리부족으로 일시중단된 상태를 나타낸다.
- 종료(Terminated) : 종료상태는 메모리와 CPU소유권을 모두 놓고 종료된 상태를 말한다. 종료는 자연스럽게 정상적인 종료도 있지만 부모프로세스가 자식 프로세스를 강제 종료시키는 경우도 존재한다.

## 프로세스의 메모리 구조

- ![캡처](https://user-images.githubusercontent.com/83262217/200122368-322e2093-8a39-4564-b92f-ea984ddd1f76.PNG)
- 코드영역 : 낮은 주소부터 코드영역은 프로그램에 내장된 소스코드가 존재하는 영역으로 기계어로 저장되어 있으며 정적인 특징을 가진다.

- 데이터영역 : 데이터 영역은 전역변수, 정적변수가 저장되고 정적인 특징을 갖는 공간이다.  
  데이터 영역은 BSS영역과 Data영역으로 나뉘며 BSS 영역은 초기화 되지 않은 변수가 0으로 최기화 되어 저장되며 Data영역은 0이 아닌 다른값으로 할당된 변수들이 저장된다.

- 힙영역 : 힙은 프로그램에 의해 동적 할당되는 영역으로 크기는 런타임시에 결정된다.

- 스택 : 스택은 지역변수, 배개변수, 실행중인 함수가 저장되고 컴파일시에 크기가 결정된다.

## PCB

```
 Process Control Block은 운영체제에서 프로세스에 대한 메타데이터를 저장한 블록을 의미하며 프로세스 제어 블록이라고도 부른다. 프로세스사 생성될때 운영체제가 해당 프로세스에 대한 PCB를 생성한다.
 프로그램이 실행되면 프로세스가 생성되고 프로세스 주소 값들에 스택, 힙, 데이터, 코드 영역등의 구조를 기반으로 메모리가 할당되며 이 프로세스에 대한 메타 데이터들이 PCB에 저장되어 관리된다. 이는 프로세스의 중요 정보를 포함하기에 임의의 접근을 막기위해 커널 스택의 가장 앞부분에서 관리된다.
```

- PCB에 저장되는 정보
  - PID: 프로세스의 고유번호
  - State: 준비, 대기, 실행 등의 상태
  - Program counter: 다음 실행될 명령어 포인터
  - 그 외에도 레지스터 관련 정보나 스케줄링 및 프로세스의 우선순위값, 할당된 자원정보 및 CPU 사용시간, 입출력 상태 정보 등의 데이터를 저장한다.

## 문맥교환

```
 Context switching은 PCB 를 교환화는 과정을 의미하며 한 프로세스에 할당된 시간이 끝나거나 인터럽트에 의해 프로세스의 상태가 변경될때 발생한다. CPU에 할당된 프로세스가 다른 프로세스로 변환될때 기존 프로세스의 PCB를 저장하고 새로 할당된 프로세스의 PCB를 로드하는 과정을 의미한다.
```

- ![캡처](https://user-images.githubusercontent.com/83262217/200122927-fafea8c1-763f-4154-86ff-1b1be04620fa.PNG)
- 컨텍스트 스위칭은 스레드에서도 발생하며 스레드는 스택 영역을 제외한 다른 메모리 공간은 공유하기 때문에 스레드 컨텍스트 스위칭은 프로세스의 컨텍스트 스위칭에 비해 비용이 적게 소모된다.
